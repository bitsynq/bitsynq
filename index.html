<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>bitsynq Panel (v0)</title>
</head>
<body style="font-family: sans-serif; margin: 40px;">
  <h1>bitsynq Contribution Panel</h1>

  <h2>Create Project</h2>
  <input id="projectName" placeholder="Project Name" />
  <button onclick="createProject()">Create</button>
  <pre id="createProjectResult"></pre>

  <hr />

  <h2>Record Contribution</h2>
  <input id="projectIdC" placeholder="Project ID" />
  <input id="userId" placeholder="User ID" />
  <input id="ratio" placeholder="Ratio (e.g., 30.5)" />
  <input id="desc" placeholder="Description" />
  <button onclick="addContribution()">Add</button>
  <pre id="contributionResult"></pre>

  <hr />

  <h2>Mint (Milestone Reward)</h2>
  <input id="projectIdM" placeholder="Project ID" />
  <input id="tokenAmount" placeholder="Tokens per milestone (e.g., 1000)" />
  <button onclick="mintMilestone()">Mint</button>
  <pre id="mintResult"></pre>

  <script>
    const API = "https://<YOUR_WORKER_URL>";

    async function createProject() {
      const name = document.getElementById("projectName").value;
      let r = await fetch(API + "/project", {
        method: "POST",
        body: JSON.stringify({ name })
      });
      document.getElementById("createProjectResult").innerText = await r.text();
    }

    async function addContribution() {
      const projectId = document.getElementById("projectIdC").value;
      const userId = document.getElementById("userId").value;
      const ratio = parseFloat(document.getElementById("ratio").value);
      const desc = document.getElementById("desc").value;
      let r = await fetch(`${API}/project/${projectId}/contribution`, {
        method: "POST",
        body: JSON.stringify({ userId, ratio, desc })
      });
      document.getElementById("contributionResult").innerText = await r.text();
    }

    async function mintMilestone() {
      const projectId = document.getElementById("projectIdM").value;
      const token_per_milestone = parseInt(document.getElementById("tokenAmount").value);
      let r = await fetch(`${API}/project/${projectId}/milestone`, {
        method: "POST",
        body: JSON.stringify({ token_per_milestone })
      });
      document.getElementById("mintResult").innerText = await r.text();
    }
  </script>
</body>
</html>
